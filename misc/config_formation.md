---
title: 配置文件笔记
categories:
  - Tool
  - Markup Language
tags:
  - Tool
  - Markup Language
  - Ini
  - Toml
  - Yaml
date: 2019-07-11 00:51:41
updated: 2025-02-05 09:09:51
toc: true
mathjax: true
comments: true
description: 配置文件笔记
---

##  Ini

##  Toml

-   *TOML*
    -   设计思路
        -   语义明显、易于阅读、最小化配置
        -   可以无歧义的映射为哈希表，应容易被解析
    -   具备实用的原生类型
        -   键值对
        -   数组
        -   表
        -   内联表
        -   表数组
        -   整数、浮点数
        -   布尔值
        -   日期、时刻（时区）
    -   其他
        -   文件扩展名：`.toml`
        -   *MIME* 类型：`application/toml`

> - *TOML*: <https://toml.io/cn/>
> - *TOML 语法规范*：<https://toml.io/cn/v1.0.0>

### 基本语法规则

-   基本语法规则
    -   规格要求
        -   大小写敏感
        -   *UTF-8* 编码
        -   空白指制表符 `0x09`、空格 `0x20`
        -   换行指 `<LF> 0x0A`、`<CR><LF> 0x0D 0x0A`
    -   注释：`#` （非字符串中）标记行余下部分为注释
        -   制表符外的控制字符不允许出现在注释中

### 基本元素

-   键值对：*TOML* 文档最基本构成区块，键名在等号的左边而值在右边
    -   键名：可裸露、`""` 引号括起、`.` 点分隔
        -   裸键：仅可包含 *ASCII* 字母、*ASCII* 数字、下划线和短横线（纯数字总被作为字符串）
        -   引号键：遵循与基本字符串或字面量字符串相同的规则
        -   点分隔键：一系列通过点相连的裸键或引号键，等价于 **嵌套键值对**
    -   键值：必须为合法 *TOML* 值类型，不指定值非法
    -   说明
        -   键名、键值、点分隔周围的空白会被忽略
        -   键值对后必须换行（或结束文件）
        -   键、等号和值必须在同一行（有些值可跨多行）
        -   重复定义键非法
    ```toml
    3.14159 = "派"
    # 等价于如下 JSON
    { "3": { "14159": "派" } }
    ```

-   字符串：仅可包含 *UTF-8* 字符
    -   基本字符串：`""` 引号包裹
        -   *Unicode* 字符可直接使用，除非需转义（引号、反斜杠、制表符外的控制字符）
        -   支持 *C0* 控制字符简写转义
    -   多行基本字符串：`"""` 三引号包裹
        -   允许换行，紧随开头引号的换行将被去除
        -   行末 `\` 反斜杠去除其后所有空白、换行
    -   字面量字符串：`''` 单引号包裹
        -   类似基本字符串，但内部禁止转义，其中内容被原样对待
        -   因不支持转义，无法在其中引入 `'` 单引号
    -   多行字面量字符串：`'''` 三单引号包裹
        -   类似多行基本字符串，但内部禁止转义
        -   可在其中引入 1、2 个单引号
    ```toml
    str = "我是一个字符串。\"你可以把我引起来\"。姓名\tJos\u00E9\n位置\t旧金山。"
    ```

-   整数
    -   （十进制）语法规范
        -   可添加 `+` 加号、`-` 减号为前缀
        -   可在数字之间用下划线来增强可读性
            -   每个下划线两侧必须至少有一个数字
        -   不允许前导零
            -   但允许 `+0`、`-0`，等价于 `0`
    -   支持 `0x`、`0o`、`0b` 前导的 16、8、2 进制非负整数
        -   不允许前导 `+`
        -   允许前导 `0`
    -   实现说明
        -   按 *64bit* 有符号整数实现
    ```toml
    int1 = +99
    int2 = 42
    int3 = 0
    int4 = -17
    int6 = 5_349_221
    # 带有 `0x` 前缀的十六进制
    hex1 = 0xDEADBEEF
    hex2 = 0xdeadbeef
    hex3 = 0xdead_beef
    # 带有 `0o` 前缀的八进制
    oct1 = 0o01234567
    oct2 = 0o755 # 对于表示 Unix 文件权限很有用
    # 带有 `0b` 前缀的二进制
    bin1 = 0b11010110
    ```

-   浮点数
    -   整数部分后跟小数部分、和或指数部分
        -   整数部分：同十进制整数值规则
        -   小数部分：小数点后跟一个或多个数字
            -   **小数点每侧必须紧邻至少一个数字**
        -   指数部分：`E/e` 后跟整数部分（可包含先导 `0`）
    -   语法规范：类似整数
    -   实现说明
        -   按 *IEEE 754 binary64* 值实现
        -   支持特殊浮点值 `inf`、`nan`
    ```toml
    flt7 = 6.626e-34
    flt8 = 224_617.445_991_228
    sf1 = inf  # 正无穷
    sf2 = +inf # 正无穷
    sf3 = -inf # 负无穷
    sf4 = nan  # 实际上对应信号非数码还是静默非数码，取决于实现
    sf5 = +nan # 等同于 `nan`
    sf6 = -nan # 有效，实际码取决于实现
    ```

-   布尔值：`true`、`false` 小写

-   坐标日期时刻：*RFC 3399* 格式的时刻日期
    -   语法规范
        -   时区偏移量可舍去
        -   可仅包含日期、时刻
        -   `T` 可替换为 ` ` 空格
    -   实现说明
        -   至少支持毫秒级精度，多余精度被舍弃
    ```toml
    # 指定有时区偏移
    odt1 = 1979-05-27T07:32:00Z
    odt2 = 1979-05-27T00:32:00-07:00
    odt3 = 1979-05-27T00:32:00.999999-07:00
    # 无时区偏移
    ldt1 = 1979-05-27T07:32:00
    ldt2 = 1979-05-27T00:32:00.999999
    # 仅日期
    ld1 = 1979-05-27
    # 仅时刻
    lt1 = 07:32:00
    lt2 = 00:32:00.999999
    ```

### 数组

-   数组：内含值的方括号
    -   语法规范
        -   括号内 `,` 分隔元素、空白被忽略
        -   允许跨行（缩进被视为空白被忽略）
        -   最后值后可跟尾逗号
        -   值、逗号、结束括号前可以存在任意数量的换行和注释
    -   实现说明
        -   数组可混合不同类型值
    ```toml
    # 允许混合类型的数组
    numbers = [ 0.1, 0.2, 0.5, 1, 2, 5 ]
    contributors = [
      "Foo Bar <foo@example.com>",
      { name = "Baz Qux", email = "bazqux@example.com", url = "https://example.com/bazqux" }
    ]
    ```

### 表

```toml
[dog."tater.man"]
type.name = "pug"
# 等价于如下 JSON
{ "dog": { "tater.man": { "type": { "name": "pug" } } }
```

-   表、哈希表、字典：键值对集合，可视为 **嵌套键值对的公共前缀抽取**
    -   语法规范：由同 `[]` 方括号作为单独行出现的表头定义
        -   表头下方直至下个表头或文件结束都是表内键值对
        -   表名规则同键名规则
        -   表内缩进被视为空白
        -   允许空表（无键值对表）
        -   不允许重复定义表（**包括键名、内联表方式隐式定义父表**）
            ```toml
            # 名为 fruit、fruit.apple 的表已被定义，不可再次定义
            fruit.apple.color = "red"
            ```
    -   实现说明
        -   表不保证键值对顺序
        -   无需完整写出所有途径父表
        -   **点分隔键最后一个键名前的每个键名创建并定义一个表**
    -   **顶层表、根表：整个 *TOML* 文件表示的表**
        -   文档开始处开始、首个表头（或文件结束）处结束
        -   没有名字、无法后置
        -   即，*TOML* 配置即原生对应键值对

####    内联表

```toml
name = { first = "Tom", last = "Preston-Werner" }
point = { x = 1, y = 2 }
animal = { type.name = "pug" }
# 同如下标准表
[name]
first = "Tom"
last = "Preston-Werner"
[point]
x = 1
y = 2
[animal]
type.name = "pug"
```

-   内联表：表的紧凑语法表示
    -   语法规范：`{}` 内包含、`,` 逗号分隔键值对
        -   键值对规范同标准表
        -   **最后键值对后不允许尾逗号**
        -   **必须在同一行内**
        -   不能在 `{}` 外再添加键、子表，也不可用于向已定义表添加子表

####    表数组

```toml
[[fruits]]
name = "apple"
[fruits.physical]       # 子表
color = "red"
shape = "round"
[[fruits.varieties]]    # 嵌套表数组
name = "red delicious"
[[fruits.varieties]]
name = "granny smith"
[[fruits]]
name = "banana"
[[fruits.varieties]]
name = "plantain"
# 等价于如下 JSON
{
  "fruits": [
    {
      "name": "apple",
      "physical": {
        "color": "red",
        "shape": "round"
      },
      "varieties": [
        { "name": "red delicious" },
        { "name": "granny smith" }
      ]
    },
    {
      "name": "banana",
      "varieties": [
        { "name": "plantain" }
      ]
    }
  ]
}
```

-   表数组：其中元素为表的数组
    -   语法规范：由 `[[]]` 双方括号括起表名表示表头
        -   表数组的引用（定义子元素时）都指向该数组里最近定义的表元素
        -   因上，表或表数组的父级是数组元素时，元素必须在定义子级前先定义
        -   可使用内联表作为数组元素
    -   实现说明
        -   表头首例定义数组、首个元素
        -   后续同名表头向数组中按顺序新增元素

```toml
# 可使用内联表方式定义表数组
points = [ { x = 1, y = 2, z = 3 },
           { x = 7, y = 8, z = 9 },
           { x = 2, y = 4, z = 8 } ]
```


##  Yaml

### 基本语法规则

-   基本语法规则
    -   基本语法规则
        -   大小写敏感
        -   缩进代表层级关系
        -   必须空格缩进
            -   不要求空格数目
            -   同层左对齐
    -   基本符号说明
        -   `-`、`:`、`?`等符号后总是需要空格
        -   `#`表示注释

### 数据结构

####    对象/映射

-   对象/映射：键值对集合
    -   格式
        -   `:`：跨行映射
        -   `{}`：行内映射

```yaml
// `:`后要空格
key: value

// 多层级对象
key:
    child_key1: val1
    child_key2: val2
// 流式表示
key: {child_key1: val1, child_key2: value2}


// 复杂对象格式：键、值都是数组
// `? `（空格）表示复杂key
? 
    - complex_key1
    - complex_key2
// `: `（空格）表示复杂value
: 
    - complex_val1
    - complex_val2
```

####    数组

-   数组
    -   格式
        -   `-`：跨行数组开头引导符
        -   `[]`：行内数组

```yaml
// `[[ele1, ele2]]`
- 
    - ele1
    - ele2


// `pkey: [{key1: val1}, {key2: val2, key3: val3}]`
pkey: 
    - 
        key1: val1
    - 
        key2: val2
        key3: val3
```

####    标量

```yaml
boolean: 
    - TRUE              # true, True均可
    - FALSE             # false, False均可

float: 
    - 3.14
    - 3.14e+2           # 科学计数法

int: 
    - 13
    - 0b1010_1010_1010_1010         #二进制

null: 
    key: ~              # `~`表示null

string:
    - 'hello world'     # 单、双引号包括特殊字符
    - line1
      line2             # 字符串可以拆成多行，换行转换为空格

datetime:
    - 2019-07-10                        # ISO 8601格式，`yyyy-MM-dd`
    - 2019-07-10T17:53:23+08:00         # ISO 8601格式，`<date>T<time>+<timezone>`
```

### 特殊符号

-   特殊符号
    -   `---`：表示文档开始
    -   `...`：文档结束
        -   二者配合在文件中记录多个yaml配置项
    -   `!!`：强制类型转换
    -   `>`：折叠换行符为空格
    -   `|`：保留换行符
    -   `&`：锚点
        -   不能独立定义，即非列表、映射值
    -   `*`：锚点引用
        -   可以多次引用
        -   被引用值可能会之后被覆盖
    -   `<<`：合并内容
        -   主要配合锚点使用
        -   相当于unlist解构

```yaml
---                         # 文档开始
string: 
    - !!str 13
    - !!str true
...                         # 文档结束

---!!set                    # 强转为set
- A1: &A1 {x: 1, y: 2}      # 定义名称为`A1`锚点
- A2: &A2 {a: 3, b: 4}      # 定义名称为`A2`锚点
- B: >                      # 折叠换行符
    this line
    will collapse
- C: |                      # 保留换行符
    this paragraph
    keeps the <CR>
- D: *A`                    # 引用名为`SS`的锚点
- E:                        # E等价于`{x:1, y:2, a:34, b:4}`
    <<: [*A1, *A2]
    a: 34
...
```

### 相关支持包

-   相关支持包
    -   Java
        -   `org.yaml.snakeyaml.Yaml`
    -   Python
        -   `PyYaml`：`import yaml`

##  Xml

